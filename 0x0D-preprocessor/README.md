this is all about preprocessing
